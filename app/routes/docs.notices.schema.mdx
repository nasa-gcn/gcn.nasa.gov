---
handle:
  breadcrumb: Schema
---

import {
  Link,
  ProcessList,
  ProcessListHeading,
  ProcessListItem,
} from '@trussworks/react-uswds'

import { Highlight } from '~/components/Highlight'
import { Tab, Tabs } from '~/components/tabs/Tabs'

import { feature } from '~/lib/env.server'

export function loader() {
  return feature('SCHEMA') || new Response(null, { status: 404 })
}

# GCN Unified Schema

Introducing the Unified Schema, a standardized framework that simplifies the creation of new GCN Notice types across various missions, observatories, and instruments, incorporating both common and mission-specific properties. We employ JavaScript Object Notation (JSON) for these Notices, a versatile internet data format with minimal ties to JavaScript. JSON offers flexibility in data representation with few structural constraints. Meanwhile, JSON Schema serves as the standard for specifying the structure, data types, and validation rules for JSON documents.

The process of crafting each mission schema involves the utilization of a set of core JSON schemas, forming the foundational building blocks for generating JSON-format Notices. This approach allows the flexibility of inclusion of mission-specific parameters while maximizing the use of the core schema. As a result, it ensures a consistent unit system for common properties across all missions.

## Fork the GitHub Repository

To begin, initiate by forking your own copy of the [nasa-gcn/gcn-schema](https://github.com/nasa-gcn/gcn-schema) repository on GitHub. Next, proceed to clone a local version and follow the project configuration instructions available at [GitHub primer](/docs/contributing/github).

## Setting Up Your Repository

The repository's structure allows producers to create their own folders to define schemas on an instrument-specific level. The schema folder is named according to the format <code>gcn.notices.<i>mission</i></code>, where <i>mission</i> is your [Kafka Topic](/docs/notices/producers). Within it, you can define your own schema and example files. For example, schema definitions for IceCube alerts are located in the directory [`gcn/notices/icecube/`](https://github.com/nasa-gcn/gcn-schema/tree/main/gcn/notices/icecube).

## Schema File Naming

Your new schema definition files should follow the naming convention <code><i>SchemaName</i>.schema.json</code>.
Examples corresponding to these schemas should follow the format, <code><i>SchemaName[.OptionalSpecification]</i>.example.json</code>. Both the <i>SchemaName</i> and <i>OptionalSpecification</i> example should be written in CamelCase formatting (ex., YourSchemaName, thisIsAlsoValid, etc.). This naming convention allows our [schema-browser](/docs/schema/stable/gcn) to generate pages based directly on the files in the latest tag.

## Sample Code

After setting up your local version, you can use the provided code samples to get started, which already include commonly used keys. Note that the `$schema` field in the example has the same value as the `$id` field in the schema.
This allows our validator script to identify which schema examples to compare. Make sure to update these files to reflect the mission and schema names. Then, you can update the `title` and `definition` fields to provide context for other users who will use this schema.

<Tabs>
  <Tab label="Sample.schema.json">
    <Highlight
      language="json"
      code={JSON.stringify(
        {
          $id: 'https://gcn.nasa.gov/schema/main/gcn/notices/<mission>/<schema name>.schema.json',
          $schema: 'https://json-schema.org/draft/2020-12/schema',
          type: 'object',
          title: 'Your Schema Name',
          description: 'A description for your schema',
          allOf: [
            {
              $ref: '/schema/gcn/notices/core/Alert.schema.json',
            },
          ],
          properties: {},
        },
        null,
        2
      )}
    />
  </Tab>
  <Tab label="Sample.example.json">
    <Highlight
      language="json"
      code={JSON.stringify(
        {
          $schema:
            'https://gcn.nasa.gov/schema/main/gcn/notices/<mission>/<schema name>.schema.json',
          alert_datetime: 'yyyy-mm-ddThh:mm:ssZ',
        },
        null,
        2
      )}
    />
  </Tab>
</Tabs>

## Defining Schema

We recommend exploring our [schema browser](/docs/schema/stable/gcn) to get an idea of what common fields have already been defined in the [Core schema](https://github.com/nasa-gcn/gcn-schema/tree/main/gcn/notices/core). Additionally, please review the [JSON Schema documentation](https://json-schema.org/) to familiarize yourself with the various keywords and types.

A good method to start formulating your structure is to think first of your data product as JSON fields. Consider the possible values that your pipelines will have for each field. In the following example, we have a schema definition for Swift/BAT-GUANO alerts. They have included the `unevaluatedProperties` property and set it to `false`, which our validator can use to verify that there are no extra properties that are undefined in the examples:

<Tabs>
  <Tab label="Alert.schema.json">
    <Highlight
      language="json"
      code={JSON.stringify(
        {
          $id: 'https://gcn.nasa.gov/schema/main/gcn/notices/swift/bat/guano/alert.schema.json',
          $schema: 'https://json-schema.org/draft/2020-12/schema',
          title: 'Swift/BAT-GUANO Alert',
          description:
            'Candidate gamma-ray transient reported from the BAT-GUANO targeted search',
          type: 'object',
          allOf: [
            {
              $ref: '/schema/gcn/notices/core/Alert.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/Event.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/DateTime.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/Localization.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/Statistics.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/Reporter.schema.json',
            },
            {
              $ref: '/schema/gcn/notices/core/AdditionalInfo.schema.json',
            },
          ],
          properties: {
            $schema: true,
            follow_up_event: {
              type: 'string',
              description:
                'Name or trigger time of the external trigger that launched the search.',
            },
            follow_up_type: {
              type: 'string',
              description:
                'Type of external trigger that launched the search, eg GW, neutrino, etc.',
            },
          },
          unevaluatedProperties: false,
        },
        null,
        2
      )}
    />
  </Tab>
  <Tab label="Alert.example.json">
    <Highlight
      language="json"
      code={JSON.stringify(
        {
          $schema:
            'https://gcn.nasa.gov/schema/main/gcn/notices/swift/bat/guano/alert.schema.json',
          mission: 'Swift',
          instrument: 'BAT-GUANO',
          messenger: 'EM',
          record_number: 1,
          alert_datetime: '2023-01-01T03:24:36.0Z',
          alert_tense: 'current',
          alert_type: 'initial',
          trigger_time: '2022-12-31T21:46:05.13Z',
          rate_snr: 15.8,
          rate_duration: 0.256,
          rate_energy_range: [15, 350],
          classification: { GRB: 1 },
          far: 0.00001,
          follow_up_event: 'Fermi 694215970',
          follow_up_type: 'GRB',
          data_archive_page:
            'https://guano.swift.psu.edu/trigger_report?id=694215995',
          id: ['694215995'],
        },
        null,
        2
      )}
    />
  </Tab>
</Tabs>

While defining JSON schema structures, please don't hesitate to [reach out](https://gcn.nasa.gov/contact) with any
questions about Schema field definitions or specific fields you are looking for.

## Validating Schema

The Git repository is configured to automatically format and validate your code at the time that you commit it. This means when you commit your updates, the validator will run to make sure that all of the schemas and their respective examples function correctly. This step also checks general formatting using the [Prettier](https://prettier.io/) formatter, which adjusts spacing, line-breaks, etc. as needed.

To validate your schemas and examples, execute the following command in the same location:

<Highlight language="sh" code="npm run validate" />

## Submit Your Schema

Once your schema and examples are validated, you can proceed to commit and push your local code to your GitHub repository.

Next, create a pull request to our [GitHub repository](https://github.com/nasa-gcn/gcn-schema), for details see [GitHub primer](/docs/contributing/github). The GCN team will review and provide feedback as needed. Once you have incorporated the feedback, we will merge your pull request into main branch. Congratulations on successfully creating your mission schema! It is now ready for production and send alerts to GCN as described in [New Notice Producers](/docs/notices/producers).
